# Лабораторная работа №1 - Математическое прогнозирование. Недобежкин Никита

## Цель работы
Разработать реализацию модели Хольта-Уинтерса с прогнозированием временного ряда. 
Дополнительно реализовать тюнинг гиперпараметров модели (параметры сглаживания и длина сезона) с использованием методов оптимизации.

## Постановка задачи
1. Реализовать модель Хольта-Уинтерса, которая принимает на вход:
   - Временной ряд.
   - Параметры сглаживания (α, β, γ).
   - Длину сезона.
   - Горизонт прогнозирования.
2. Выполнить тюнинг параметров модели (оптимизация α, β, γ и длины сезона) с помощью методов оптимизации.
3. На выходе программа должна предоставлять:
   - Прогнозные значения.
   - Последние коэффициенты модели (линейный тренд, сезонность).
   - Оптимальные параметры сглаживания и длину сезона.

## Краткое описание модели

Модель Хольта-Уинтерса — это метод прогнозирования временных рядов, который используется для учета сезонных колебаний. Она включает три основных компонента:

Уровень (L) — сглаженное значение временного ряда.
Тренд (T) — изменение уровня временного ряда с течением времени.
Сезонность (S) — периодические колебания данных.

![image](https://github.com/user-attachments/assets/0dfff4fb-df3f-4358-bb6c-da7599cb0d7f)


## Решение поставленной задачи:

## 1. Исходные данные (данные о количестве пассажиров на авиалиниях USA с 1949 по 1960 года)

AirPassengers Dataset — это классический временной ряд, содержащий ежемесячные данные о количестве пассажиров международных авиалиний за период с января 1949 года по декабрь 1960 года.

![image](https://github.com/user-attachments/assets/8453ba20-a0f8-4c81-aff2-bc3538f32c4e)

## 2. Аддитивное декомпозирование. 

Декомпозируем исходный график(1 рисунок) на: тренд (2 рисунок), сезонность (3 рисунок) и шум (4 рисунок)

![image](https://github.com/user-attachments/assets/302097a7-5bde-4e66-b036-4c59e6f7edf1)

## 3. Прогноз с зафиксированными параметрами с помощью модели Хольта-Уинтерса:

![image](https://github.com/user-attachments/assets/9f5dd1e5-cb06-466b-8ea1-a201e2621d29)


## 4. Прогноз с помощью scipy.optimize:

![image](https://github.com/user-attachments/assets/89eddf6e-2516-4d58-8d47-9b4e4119ec7c)


## 5. Прогноз с помощью optuna(на 1000 итерациях):

![image](https://github.com/user-attachments/assets/1bcbe955-d458-4f2f-a563-301c67bd6e51)


## 6. Сравнение реальных данных с прогнозными(optuna на 1000 итерациях и scipy практически идентичны), но различается MSE:
MSE for Optuna optimized model: 256.38

MSE for Scipy optimized model: 255.50

![image](https://github.com/user-attachments/assets/89be69a8-c00b-4873-a9b3-869e19c4b458)

## 7. Выводы

**1. Сезонность и трендность в данных:**
На основе проведенной декомпозиции можно сделать вывод, что данные действительно содержат ярко выраженные компоненты сезонности и тренда. Это подтверждается тем, что модель Хольта-Уинтерса, которая предназначена для работы с такими временными рядами, показала хорошие результаты.
Влияние сезонных колебаний и тренда на данные важно для понимания, почему прогнозы модели оказываются эффективными, так как она адаптируется к этим компонентам.

**2. Процесс оптимизации с использованием scipy.optimize:**
Оптимизация модели с помощью scipy.optimize продемонстрировала хорошие результаты и позволила настроить параметры модели (α, β, γ) для минимизации ошибки прогноза. Это подтверждает, что методы оптимизации могут эффективно находить наилучшие параметры для модели Хольта-Уинтерса.
Можно отметить, что для улучшения качества прогнозов важен тщательный подбор этих параметров, так как даже небольшие изменения в их значениях могут значительно повлиять на результат.

**3. Использование optuna для оптимизации:**
Оптимизация с помощью optuna продемонстрировала несколько худший результат по MSE по сравнению с scipy.optimize. Однако разница может быть небольшой, и это может говорить о том, что для данного конкретного набора данных и модели оптимизация с помощью scipy.optimize может быть более эффективной.
Однако стоит отметить, что optuna является более универсальным инструментом, который может работать с различными моделями и параметрами, предоставляя дополнительные возможности для настройки и выбора гиперпараметров. Поэтому результаты немного хуже могут быть объяснены специфичностью подхода или особенностями работы с временными рядами в данной модели.

**4. Сравнение моделей и значимость результата:**
Хотя scipy.optimize показал чуть более низкий MSE, важно отметить, что разница между результатами обеих моделей невелика. Это может свидетельствовать о том, что обе оптимизации (с использованием scipy.optimize и optuna) могут быть вполне эффективными для данной задачи и, возможно, не требуется вносить большие изменения в параметры модели.
Важно также учитывать, что optuna может быть полезен в более сложных сценариях с большими наборами гиперпараметров или более сложными моделями, где его возможности для поиска глобальных оптимумов и работы с несколькими параметрами могут проявиться в полной мере.

**5. Выводы для практического применения:**
Для данной задачи оптимизация с использованием scipy.optimize кажется чуть более эффективной по MSE, однако оба метода могут быть использованы для прогнозирования временных рядов с сезонностью и трендом.
В зависимости от требований к модели (скорость, гибкость, точность) можно выбрать один из методов. Если важна скорость и простота, scipy.optimize может быть предпочтительнее. Если же требуется более гибкая настройка и работа с большим количеством параметров, то optuna будет хорошим выбором.


